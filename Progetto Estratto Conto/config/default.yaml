# config/default.yaml
# -------------------
# Purpose:
#   Default configuration for the "Progetto Estratto Conto" ML pipeline.
#   Centralizes data paths, feature engineering switches, model parameters,
#   and training / prediction behavior.
#
# Notes:
#   - Paths are relative to project root on host and to /app in Docker.
#   - CSVs are UTF-8, '.' decimal separator, dates as YYYY-MM-DD.
#   - Compatible with src/training/train.py and src/predictions/predict.py.

# ------------------------------------------------------------
# Data configuration
# ------------------------------------------------------------
data:
  raw_path: "data/sample_data.csv"        # synthetic data generated by src/data/generator.py
  processed_path: "data/processed/"
  model_dir: "models/"
  logs_dir: "logs/"
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15

# ------------------------------------------------------------
# Feature engineering settings
# ------------------------------------------------------------
features:
  include_day_features: true         # adds day_of_week, weekend
  include_lag_features: true         # compute past-N-days spend averages
  lag_days: [7, 14, 30]              # lag periods for moving sums
  include_rolling_stats: true        # rolling mean/std on numeric cols
  rolling_windows: [7, 30]           # rolling window sizes in days
  include_categorical: true          # one-hot encode categorical variables
  include_amount_features: true      # derive absolute, normalized amounts
  target_column: "saldo_disponibile" # regression target

# ------------------------------------------------------------
# Model configurations
# ------------------------------------------------------------
regressor:
  model_type: "random_forest"        # options: random_forest | gradient_boosting | neural_network
  hyperparameters:
    n_estimators: 200
    max_depth: 12
    min_samples_split: 4
    min_samples_leaf: 2
    random_state: 42
    n_jobs: -1

classifier:
  model_type: "random_forest"
  hyperparameters:
    n_estimators: 100
    max_depth: 8
    random_state: 42
    n_jobs: -1

# ------------------------------------------------------------
# Training parameters
# ------------------------------------------------------------
training:
  save_best_model: true
  model_save_path: "models/latest.joblib"    # absolute path built relative to project root
  metrics_path: "data/processed/training_metrics.json"
  log_path: "logs/training.log"
  verbose: true
  random_state: 42
  early_stopping: false                     # reserved for neural_network / gradient_boosting

# ------------------------------------------------------------
# Prediction parameters
# ------------------------------------------------------------
prediction:
  model_path: "models/latest.joblib"
  input_path: "data/raw/sample_data.csv"
  output_path: "data/processed/predictions.csv"
  batch_size: 2048
  confidence_threshold: 0.7                 # threshold for anomaly alerting
  include_input_columns: true               # include original fields in output
  output_columns:
    - id_movimento
    - data_movimento
    - categoria
    - sottocategoria
    - importo
    - y_pred
    - y_true
  alert_tif_exceed_budget: true
  monthly_budget: 2500     
         # flag records exceeding threshold

# ------------------------------------------------------------
# Logging setup
# ------------------------------------------------------------
logging:
  level: "INFO"
  file: "logs/app.log"
  rotation: "1 week"
  retention: "4 weeks"